---
layout: post
title: 设计
categories: 程序设计
related_posts: True
tags:
toc:
  sidebar: left
---

## 设计

### 1. 开发层面的设计

设计是开发经常谈论的一个东西，但设计这个词似乎又涵盖了太多相似但不重合的领域，比如说`设计模式`、`系统设计`等等。所以当讨论设计的时候，往往不清楚在讨论什么的设计。其中狭义的`设计模式`一般只是指那三大类和二十三小类，解决的是特定场景下如何减少代码重复性，降低模块耦合能力等等；而`系统设计`则更侧重于业务的实现，换句话说就是如何将一个产品需求转为一个可编程模型，然后通过代码的方式实现产品需求。这两者完全是截然不同的两种能力，前者是代码的具体实现，后者是基于需求如何抽象出不同模块。

除了以上两种设计之外，其实还能再细细区分开来。比如说我已经`系统设计`了若干个模块，但是这些和业务绑定的这些模块如何实现呢？比如说undo-redo如何实现、命令分发如何实现等等。为了和狭义的`设计模式`中的三大类二十三小类区分开来，我就命名这种设计为`模块设计`了。除此之外，还有`优化设计`、`数据设计`以及`开发规范设计`等等。这些概念后面会继续阐述。

我认为厘清这些概念，能够有助于能够从不同角度去理解设计。明白当前设计需要考虑什么。

#### 1.1 **设计模式**：

- **定义**：设计模式是针对特定问题的通用解决方案，`旨在提高系统的灵活性和可扩展性，方便修改，方便维护`。
- **作用**：
  _ 不要重复：设想如果一份代码中存在大量重复代码，当这些重复代码需要修改时，就会有多处需要修改，扩展起来非常麻烦;
  _ 不要耦合：如果代码之间耦合度高，改动一处会影响到其他部分，就会导致扩展性差的问题；\* 不要模块混乱：如果项目内部模块依赖混乱，当需要多人开发不同模块时，提交代码会非常麻烦，不是单纯一方接受另一方的变更即可，而是双方需要来回修改提交代码才能合并。这本质上也是一种扩展性差的问题。
- **示例**：三大类二十三小类等等、condition-action等等。

#### 1.2 **系统设计/架构设计/业务设计**：

- **定义**：架构设计是对整个系统的高层次设计，涉及系统的整体结构和各个模块的划分。也可以理解为`如何将一个产品需求转换成为一个编程语言可实现的模型`，则是这一层级设计所探讨的。
- **作用**：
  - 满足业务：系统设计通过系统化的方法构建和工程化系统，以满足业务或组织的需求。系统设计需要考虑从基础设施到数据存储的所有方面。还需要结合业务需求，划分不同的模块。
  - 满足性能：分析哪些模块可能成为性能瓶颈并调整。比如说日活跃用户1k和日活跃用户100k的网站，其整体架构就不可能一样。按照100k设计1k的网站，必然会增加维护成本；按照1k的设计100k的则必然经常崩溃，这种问题则往往需要系统层面的重构。因此一开始至少要知道某一个那一个模块可能会成为性能瓶颈，这个模块的性能瓶颈能不能克服。
- **示例**：一个电商系统的系统设计可能包括用户管理模块、商品管理模块、订单处理模块、支付系统、数据库表结构设计和API接口设计等。具体流程可能会有客户端发出请求、服务器端处理请求、校验余额、保证安全、存储数据、实现事务性等等。
- **示例**：摇一摇、漂流瓶、扫码登录。可能是一个微服务程序，单独一个模块有完整的能力。

#### 1.3 **模块设计**：

- **定义**：模块设计是对系统中具体模块的设计，`强调某一个具体功能具体实现的通用方式`。往往是架构设计的子层级，即一个具体模块甚至更小的一个功能采取怎样的设计方式，强调的是某一个具体功能的抽象。
- **作用**：设计具体模块或功能的实现方式，提高模块的独立性和可维护性。
- **示例**：就比如说undo-redo的实现，有哪些操作是需要undo-redo的，怎么注册？怎么存储？怎么回滚？其他还有事件队列、命令分发器、消息中心、状态机等。

#### 1.4 **优化设计**：

- **定义**：优化设计是`基于某些先验假设，或者通过一些tradeoff做出的优化改进，最常见的就是提升复杂性来带来提升`。
- **作用**：在特定场景下，通过优化设计提升系统性能。
- **示例**：比如说一个ABA问题是不重要的，我就可以使用CAS（Compare-And-Swap）操作，通过无锁方式保证线程安全；又比如说CTRP，把开销挪到编译时。

#### 1.5 **数据设计**：

- **定义**：`数据设计涉及数据的存储、组织和管理`，包括数据库设计、数据模型设计等。
- **作用**：确保数据的完整性、一致性和高效访问。
- **示例**：设计一个关系数据库模式，定义表、字段和关系；缓存数据的设计等等；

#### 1.6 **开发规范设计**：

- **定义**：开发规范设计，`是静态检查以及团队共识`。
- **作用**：规范代码编写，提升代码质量；提升可读性，使得能够基于团队共识就能够快速理清代码意图。
- **示例**：一些命名规范，工程如何组织，哪些是对外函数，哪些是对内函数。

### 2. 其他设计

除了这些开发层面上存在的设计之外，其实还有一些其他层面上的设计。

#### 2.1 **用户体验设计（User Experience Design, UX Design）**：

- **角度**：产品角度
- **定义**：用户体验设计关注用户在使用产品时的整体体验，包括界面设计、交互设计、信息架构等。
- **作用**：提高产品的可用性和用户满意度。
- **示例**：设计一个直观的用户界面，使用户能够轻松完成任务。

#### 2.2 **测试设计（Test Design）**：

- **角度**：测试角度
- **定义**：测试设计涉及测试用例的编写、测试策略的制定和测试工具的使用。
- **作用**：确保软件的质量和可靠性。
- **示例**：编写单元测试、集成测试和端到端测试用例，使用自动化测试工具进行测试。

#### 2.3 **持续集成和持续部署设计（CI/CD Design）**：

- **角度**：运维角度
- **定义**：CI/CD 设计涉及自动化构建、测试和部署流程的设计。
- **作用**：提高开发效率，减少手动操作，确保代码的持续交付。
- **示例**：使用 Jenkins 或 GitHub Actions 设置自动化构建和部署流水线。

#### 2.4 **安全设计（Security Design）**：

- **角度**：安全角度，其实本质上也可以认为是开发的角度，但一般开发和安全开发还是有较大生殖隔离，因此独立出来。
- **定义**：安全设计关注系统的安全性，包括身份验证、授权、数据加密等。
- **作用**：保护系统和数据免受未经授权的访问和攻击。
- **示例**：设计一个多因素身份验证系统，确保只有授权用户可以访问系统。

### 3. 总结

这里对各个场景下的设计给出了定义和示例。这些概念更多是个人的经验划分，并不完全是开发者群体的集体共识。
但个人觉得明确了这些不同设计层次的一些本质概念，将更有助于在实践中开发运用。
后面也会接着补充开发层面设计的相关博文。

### 98. ref

1. https://github.com/checkcheckzz/system-design-interview
2. https://github.com/InterviewReady/system-design-resources
3. https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1%E4%B8%BB%E9%A2%98%E4%BB%8E%E8%BF%99%E9%87%8C%E5%BC%80%E5%A7%8B
